function cache_store(e,a,t,c,o){if("undefined"==typeof Storage)return!1;var i="cached-"+t+"-"+e+"-"+a;void 0===o&&(o=Math.floor((new Date).getTime()/1e3));var n={component:e,identifier:a,version:o,data:c};try{localStorage.setItem(i,JSON.stringify(n))}catch(e){cache_flush();try{localStorage.setItem(i,JSON.stringify(n))}catch(e){return!1}}return n}function cache_fetch(e,a,t){if("undefined"==typeof Storage)return!1;var c="cached-"+t+"-"+e+"-"+a;return data=localStorage.getItem(c),null!==data&&JSON.parse(data)}function cache_delete(e,a,t){if("undefined"==typeof Storage)return!1;var c="cached-"+t+"-"+e+"-"+a;return localStorage.removeItem(c),!0}function cache_flush(){if("undefined"==typeof Storage)return!1;localStorage.clear()}function validate_cacheable_views(){var t=!1,c=Cookies.getJSON("cached_views");void 0!==c&&$.each(c,function(e,a){!1===cache_fetch(a.component,a.identifier,"view")&&(delete c[e],t=!0)}),!0===t&&($.isEmptyObject(c)?Cookies.remove("cached_views"):Cookies.set("cached_views",c));for(var e=0;e<localStorage.length;e++)if("cached-view-"==localStorage.key(e).substring(0,12)){var a=localStorage.key(e),o=JSON.parse(localStorage.getItem(a));announce_cacheable_view(o.component,o.identifier,o.version)}}function process_cacheable_views(){$('div[data-type="cacheable"]').each(function(){var e=$(this).attr("data-component"),a=$(this).attr("data-identifier"),t=$(this).attr("data-version"),c=$(this).html();""===c?!1===(c=cache_fetch(e,a,"view"))?load_cacheable_view(e,a,this):$(this).html(c.data):(cache_store(e,a,"view",c,t),announce_cacheable_view(e,a,t))})}function announce_cacheable_view(e,a,t){var c=e+"-"+a,o=Cookies.getJSON("cached_views");void 0===o&&(o={}),(!o.hasOwnProperty(c)||o.hasOwnProperty(c)&&o[c].version!=t)&&(o[c]={component:e,identifier:a,version:t},Cookies.set("cached_views",o))}function load_cacheable_view(a,t,c){var e="http://localhost/caching/index.php?component="+a+"&identifier="+t;$.ajax({url:e}).done(function(e){data=JSON.parse(e),cache_store(a,t,"view",data.data,data.version),announce_cacheable_view(a,t,data.version),$(c).html(data.data),console.log("Load view from endpoint ...")})}$="undefined"==typeof $&&"undefined"!=typeof jQuery?jQuery:$,$(document).ready(function(){validate_cacheable_views(),process_cacheable_views()});